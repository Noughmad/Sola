\documentclass[a4paper,10pt]{article}

\usepackage[utf8]{inputenc}
\usepackage[slovene]{babel}
\usepackage{amsmath}
\usepackage{hyperref}
\usepackage[nottoc,numbib]{tocbibind}
\usepackage[left=3cm,right=3cm,top=3cm,bottom=3cm]{geometry}

\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{comment}
\usepackage[smaller]{acronym}

\usepackage{tikz}
\usetikzlibrary{calc}

\tikzset{egrid/.style={draw,help lines}}
\tikzset{mgrid/.style={draw,help lines,dashed}}
\tikzset{epoint/.style={draw,circle,red,inner sep=2pt,fill}}
\tikzset{mpoint/.style={draw,circle,blue,inner sep=2pt,fill}}

\newcommand{\todo}[1]{(\textbf{\textsmaller{TODO}: #1})}
\newcommand{\odvod}[2]{\frac{\partial #1}{\partial #2}}
\renewcommand{\vec}{\mathbf}
\newcommand{\eps}{\varepsilon}
\newcommand{\E}{\vec E}
\newcommand{\B}{\vec B}
\newcommand{\angl}[1]{(\textit{angl. #1})}

\acrodef{FDTD}{Finite-difference time-domain}
\acrodef{ABC}{Absorbing boundary condition}
\acrodef{PML}{Perfectly-matched layer}

\renewcommand{\acf}[1]{\acl{#1} -- \acs{#1}}

%opening
\title{Magistrsko delo}
\author{Miha \v Can\v cula}

\begin{document}

\maketitle

\section{Uvod} % 1.5 - 3 strani


Strukture za usmerjanje svetlobe igrajo pomembno vlogo v sodobnih opti"cnih komunikacijskih sistemih\cite{ruetschi-1994}. 
\todo{Zakaj so valovodi dobri}

% Zakaj so valovodi dobri, uporaba v mehki snovi


% TODO: Na kratko o vseh valovodih

Teko"ci kristali so mehke snovi, ki zdru"zujejo lastnosti kristalov in teko"cin\cite{degennes}. 
Praviloma so teko"ci kristali sestavljeni iz pali"castih ali diskastih molekul, teko"cekristalne mezofaze pa tvorijo tudi segmenti \textsmaller{DNK}, molekule nekaterih virusov in primerni koloidni delci. 
Polo"zaji gradnikov nimajo reda dolgega dosega, ali pa ta red ne dr"zi v vseh treh dimenzijah, zato se snov obna"sa kot teko"cina. 

Orientacijski red v teko"cih kristalih lahko tak"sen red opi"semo s preferen"cno orientacijo oz. direktorjem $\mathbf{n}$ in stopnjo reda $S$. 
Na prosto energijo in s tem na ureditev teko"cega kristala vplivajo krajevno spreminjanje direktorja, temperatura in dielektri"cna interakcija. 
Za opti"cne lastnosti je pomembna predvsem dvolomnost, kar pomeni, da je lomni koli"cnik snovi odvisen od polarizacije svetlobe. 
Ta anizotropija izhaja iz oblike gradnikov, ki so v ve"cini primerov pali"caste molekule. 
V teko"cem kristalu z orientacijskim redom os dvolomnosti sledi orientaciji gradnikov. 

% TODO: Valovodi s teko"cimi kristali (clanki, reference, literatura)

Teko"cekristalni laserji so v zadnjem "casu dele"zni veliko pozornosti \cite{coles-morris, humar-musevic, humar-ravnik}. 
Klju"cna dejavnika pri uporabi teko"cih kristalov v laserjih sta prisotnost fotonskega prepovedanega pasu (ang. photonic bandgap) in mo"znost zunanjega nadzora s spreminjanjem elektri"cnega polja ali temperature.

% Struktura diplome
V teoreti"cnem delu te naloge je opisana osnovna teorija ureditve teko"cih kristalov, njihove opti"cne lastnosti in "sirjenje svetlobe skoznje. 
Poudarek je na cilindri"cnih strukturah, ki so najbolj primerne za tvorbo valovodov. 
Poleg tega so opisane splo"se lastnosti in uporabe valovodov in posebnosti teko"cekristalnih valovodov. 

V tretjem poglavju je predstavljena numeri"cna metoda, s katero sem modeliral "sirjenje svetlobe skozi teko"cekristalne valovode, in nekaj preizkusov njene pravolnosti. 
V "cetrem poglavju so rezultati \todo{kaj to"cno?}. 

\section{Teoreti"cno ozadje}

\subsection{Teko"ci kristal kot anizotropni dielektrik}
% Tenzor Q, prosta energija

V teko"cem kristalu imajo gradniki orientacijski red dolgega dosega. Definiramo lahko enotski vektor $\mathbf{n}$, ki dolo"ca povpre"cno smer gradnikov in ga imenujemo direktor. Direktor ni pravi vektor, saj v teko"cem kristalu ne lo"cime med smerjo $\mathbf{n}$ in $\mathbf{-n}$. Tudi "ce sami gradniki nimajo tak"sne simetrije, jo imajo njihove fluktuacije, zato lahko ureditev dobro opi"semo z direktorjem\cite{mermin}. 

\begin{comment}
\begin{figure}[h]
\begin{center}
\subfigure{\includegraphics[height=100pt]{./Slike/Nematic-Director}}
\subfigure{\includegraphics[height=100pt]{./Slike/nematik-formuli}}
 \caption{Levo: Gradniki imajo razli"cne orientacije, preferen"cno smer pa poda direktor. Desno: Strukturni formuli molekul 5CB (zgoraj) in 8CB (spodaj)\cite{wiki:lc}}
 \label{fig:nematik-direktor}
 \end{center}
\end{figure}

Orientacijski red dolgega dosega je tipi"cno realiziran s pali"castimi gradniki. Najpogosteje se uporabljajo organske molekule z dvema benzenovima obro"cema, na katera so vezane razli"cne skupine. Primera tak"snih molekul sta 4-ciano-4'-pentilbifenil (5CB) in 4-ciano-4'-oktilbifenil (8CB), katerih strukturni formuli sta prikazani na Sliki \ref{fig:nematik-direktor}. Velikosti tak"snih molekul so nekaj nanometrov. 

\end{comment}

Direktor $\mathbf{n}$ podaja povpre"cno smer gradnikov, ne pa dejanske orientacije posameznih gradnikov. 
Zato uvedemo "se stopnjo reda $S$ \angl{degree of order}, ki nam pove, koliko smeri molekul v povpre"cju odstopajo od direktorja. 
Zaradi simetrije $\mathbf{n} \leftrightarrow -\mathbf{n}$ ne moremo vzeti kar povpre"cne vrednosti kota med gradnikom in direktorjem, saj je ta vrednost enaka ni"c. 
Namesto tega uporabimo povpre"cni kvadrat kota, ki je ekvivalenten kvadrupolnemu momentu\cite{kleman}
\begin{align}
 S = \frac{1}{2}\left(3\langle\cos^2\vartheta\rangle-1\right),
\end{align}
kjer je $\vartheta$ kot med osjo gradnika in direktorjem, $\langle\rangle$ pa prostorsko ali "casovno povpre"cje. 
Pri tak"sni definiciji ima popolnoma urejen teko"ci kristal, kjer so vsi gradniki vzporedni z direktorjem, vrednost $S=1$, povsem neurejen teko"ci kristal z naklju"cnimi orientacijami molekul pa $S=0$. 
V Landauovi teoriji faznih prehodov je ureditveni parameter neka koli"cina, ki je v eni fazi enaka ni"c, v drugi pa od ni"c razli"cna. 
Zgoraj definirana stopnja reda $S$ je tako primeren ureditveni parameter za prehod med izotropno teko"cino in teko"cekristalno fazo\cite{degennes}. 

Direktor in nematsko stopnjo reda lahko hkrati opi"semo z eno tenzorsko koli"cino. V ta namen uvedemo tenzor ureditvenih parametrov $Q_{ij}$ kot
\begin{align}
  Q_{ij} = \frac{S}{2}(3n_i n_j - \delta_{ij}) + \frac{P}{2}(e^{(1)}_i e^{(1)}_j - e^{(2)}_i e^{(2)}_j)\,,
\end{align}
kjer sta $\mathbf{e}^{(1)}$ in $\mathbf{e}^{(2)}$ enotska vektorja, pravokotna na $\mathbf{n}$ in med seboj. Uvedli smo "se biaksialnost $P$, ki je neni"celna, "ce fluktuacije molekul niso simetri"cne na vrtenje okrog direktorja. V tem primeru imamo orientacijski red tudi v sekundarni osi, ki je pravokotna na direktor in jo imenujemo sekundarni direktor. Parameter $P$ ima podoben pomen kot $S$ in nam pove, kako dobro so gradniki urejeni glede na sekundarno direktor. Ker komponente $n_i$ nastopajo le v kvadratu, s tak"snim zapisom avtomatsko upo"stevamo simetrijo direktorja, saj zamenjava $\mathbf{n}$ z $-\mathbf{n}$ tenzorja $Q_{ij}$ ne spremeni. Ker je $\mathbf{n}$ enotski vektor, je tenzor $Q_{ij}$ brezsleden, zato so v izotropni snovi vse njegove komponente enake 0 in je primeren ureditveni parameter za opis faznih prehodov. 

\subsubsection{Deformacije direktorja in prosta energija}

Ureditev teko"cega kristala lahko opi"semo s tenzorskim poljem $Q_{ij}(\vec r)$, ki podaja tenzor ureditvenih parametrov v vsaki to"cki. 
Skupno prosto energijo lahko izrazimo kot funkcional polja $Q_{ij}(\vec r)$, ki pa je odvisen od teko"cekristalne mezofaze. 
V tej nalogi obravnavamo le dve izmed mnogih teko"cekritalnih mezofaz, in sicer nematsko in holesteri"cno. 
K prosti energiji teh dveh mezofaz prispevajo elasti"cne deformacije, stopnja reda in dielektri"cna interakcija z elektri"cnim poljem. 
Drugi prispevki, npr. magnetna interakcija in fleksoelektri"cnost, so pri obi"cajno uporabljanih snoveh in opti"cnem polju zanemarljivi.

\begin{figure}[h]
\begin{center}
  \includegraphics[width=.7\textwidth]{./Slike/tsb_slo}
  \caption{Trije na"cini elasti"cne deformacije direktorja. }
\label{fig:tsb}
\end{center}
\end{figure}
Posamezni gradniki imajo najve"cjo svobodo gibanja in s tem najve"cjo entropijo, "ce je direktor in s tem tudi teznor $Q_{ij}$ uniformen. 
Krajevno spreminjanje ureditvenega parametra $Q_{ij}$ v katerikoli smeri povzro"ci, da sistemu prosta energija naraste. 
To pove"canje je odvisno od smeri spreminjanja $Q_{ij}$ glede na smer direktorja. 
Na sliki \ref{fig:tsb} so prikazani trije na"cini deformacije direktorja, s katerimi lahko lokalno opi"semo poljubno krajevno odvisnost. 
Ti trije na"cini so pahlja"ca \angl{splay}, zvoj \angl{twist} in upogib \angl{bend}. 

V splo"snem so elasti"cne konstante, ki pripadajo vsakemu izmed treh osnovnih na"cinom deformacije, med seboj razli"cne. 
Prispevek k gostoti proste energije zaradi elasti"cnih deformacij nematskega teko"cega kristala je tako enak

\begin{align}
 f_{\mathrm{el}}^N &= \frac{K_1}{2} (\nabla \cdot \vec n)^2 + \frac{K_2}{2} (\vec n \cdot \nabla \times \vec n)^2 + \frac{K_3}{2} (\vec n \times \nabla \times \vec n)^2. 
\end{align}

\todo{tipi"cne vrednosti konstant}, \todo{izra"zava s $Q_{ij}$}

V kiralnem nematiku oz. holesteriku pa ima stanje z najni"zjo prosto energijo konstanten zvoj s periodo $a = 2\pi / q$.
Drugi "clen tako ni ve"c simetri"cen glede na smer deformacije, gostota proste energije v holesteriku pa je enaka

\begin{align}
 f_{\mathrm{el}}^{Ch} &= \frac{K_1}{2} (\nabla \cdot \vec n)^2 + \frac{K_2}{2} (\vec n \cdot \nabla \times \vec n - q)^2 + \frac{K_3}{2} (\vec n \times \nabla \times \vec n)^2. 
\end{align}

V teko"cih kristalih je stabilnost nematske mezofaze odvisna od temperature ali od koncentracije. 
Za termotropske teko"ce kristale, kjer je mezofaza odvisna od temperature, lahko zapi"semo Landauov razvoj proste energije po ureditvenem parametru $Q_{ij}$ kot
\begin{align}
  f_{\mathrm{L}} = \frac{1}{2}a(T-T^*)Q_{ij}Q_{ji} + \frac{1}{3}BQ_{ij}Q_{jk}Q_{ki} + \frac{1}{4}C(Q_{ij}Q_{ji})^2,
\end{align}
kjer je $T$ temperatura, $T^*$ najni"zja mo"zna temperatura podhlajene izotropne faze, $a$, $B$ in $C$ pa "cleni Landauovega razvoja in so odvisni od snovi. 
Ker sta konstanti $a$ in $C$ pozitivni, je pri temperaturi nad $T^*$ najugodnej"se stanje $Q_{ij}=0$ oz. $S=0$, kar ustreza izotropni snovi. 
Pri temperaturi pod $T^*$ pa kvadratni "clen zamenja predznak, zaradi "cesar postane stabilno tudi stanje z neni"celnim ureditvenim parametrom, torej nematska mezofaza. 

Na ureditev pa vpliva tudi zunanje elektri"cno polje. 
Prispevek k prosti energiji lahko razdelimo na prispevek izotropnega dela dielektri"cnega tenzorja $\overline\varepsilon$, ki ni odvisen od ureditve teko"cega kristala, in prispevka dielektri"cne anizotropije, ki predstavlja sklopitev med ureditvijo in elektri"cnim poljem. 
Skupna sprememba proste energije je enaka
\begin{align}
  f_{\mathrm{EM}} = -\frac{1}{2}\varepsilon_0 \left(\overline\varepsilon E_i E_i + \frac{2}{3}\varepsilon_a^{\mathrm{mol}} Q_{ij}E_iE_j \right),
\end{align}
kjer je $\overline{\varepsilon}$ povpre"cna dielektri"cna konstanta, $\varepsilon_a^{\mathrm{mol}} = \varepsilon_{\parallel}^{\mathrm{mol}} - \varepsilon_{\perp}^{\mathrm{mol}}$ dielektri"cna anizotropija posamezne molekule, $E_i$ pa zunanje elektri"cno polje. 
"Ce na teko"ci kristal svetimo, ureditev molekul ne more slediti hitremu spreminjanju opti"cnega elektri"cnega polja, ampak nanj efektivno deluje povpre"cen kvadrat polja. 
Ta sklopitev izhaja iz polarizabilnosti molekul, ki je odvisna od njihove oblike. 
Zunanje polje v molekuli inducira elektri"cni dipolni moment, ki je sorazmeren z dol"zino molekule in je zato najve"cji, "ce je polje vzporedno z osjo molekule. 

\subsubsection{Direktor v cilindri"cni kapilari}

Nematski teko"ci kristal se spontano uredi tako, da minimizira prosto energijo. 
V odsotnosti zunanjega polja je prosta energija najni"zja, "ce ni elasti"cnih deformacij, torej je direktor uniformen. 
V cilindri"cni geometriji s homeotropnimi robnimi pogoji pa tak"sna ureditev ni mo"zna. 
Glede na razmerja med elasti"cnimi konstantami se teko"ci kristal uredi v eno izmed konfiguracij na sliki \ref{fig:director-profiles}. 

\begin{figure}[h]
\centering
\subfigure{\includegraphics{./Slike/director-profile-cylinder-kleman}}
\subfigure{\includegraphics{./Slike/escaped-director-energy}}
\caption{Levo: Prerezi valja s singularno (a) in nesingularno pobeglo disklinacijo (b). 
Razli"cne smeri pobega povzro"cija nastanek to"ckastih singularnosti (c). Desno: Energija singularne in pobegle konfiguracije v odvisnosti od razmerja med elasti"cnima kostantama $K_1$ in $K_3$\cite{kleman}. }
 \label{fig:director-profiles}
\end{figure}

V profilu s singularno disklinacijo v osi valja je prisotna le pahlja"cna deformacija, zato je energija tega stanja odvisna od konstante $K_1$. 
V pobeglem profilu pa sta prisotni tako pahlja"cna kot upogibna deformacija. Energija tega stanja je odvisna od konstant $K_1$ in $K_3$. Do pobega pride, "ce je razmerje $K_3/K_1$ manj"se od 13, kar velja za ve"cino nematskih teko"cih kristalov. Z minimizacijo energije lahko izpeljemo ravnovesni radialni profil direktorja v cilindri"cnih koordinatah. V poenostavljenem primeru, ko sta elasti"cni konstanti $K_3$ in $K_1$ enaki, je energijsko najugodnje"se stanje\cite{kleman} 
\begin{align}
 \vec n &= (n_r, n_\phi, n_z) = (\cos \chi(r), 0, \sin \chi(r)) \\
 \chi(r) &= 2 \arctan \frac{R-r}{R+r}
\end{align}
kjer je $R$ polmer valja. Tak"sen profil je prikazan na sliki \ref{fig:director-profiles}b. 

V primeru pobega v tretjo dimenzijo je direktor povsod dobro definiran. "Ce pa do pobega ne pride, je tik ob osi valja obmo"cje zmanj"sanega reda, kjer ureditveni parameter $S$ pade na 0. 

\subsubsection{Valj z dvojnim zvojem}

Holesteri"cni teko"ci kristal ima najni"zjo prosto energijo, "ce ima stalen zvoj. 
\todo{Mogo"ce kaj vec o double-twist cylindrih}

\begin{figure}
 \centering
 \includegraphics[width=.5\textwidth]{./Slike/double-twist-cylinder-coles-morris}
 \caption{Shematski prikaz direktorja v valju z dvojnim zvojem. Na osi valja je direktor vzporeden z osjo, z oddaljenostjo od osi pa kot med osjo in direktorjem nara"s"ca linearno\cite{coles-morris}. }
 \label{fig:double-twist-cylinder}
\end{figure}

\subsection{Maxwellove ena"cbe v neizotropnem sredstvu}
"Sirjenje svetlobe po snovi opisujejo "stiri Maxwellove ena"cbe
\begin{equation}
\begin{aligned}
 \nabla \cdot \vec D = \rho_f & \qquad \nabla \cdot \vec B = 0 \\
 \nabla \times \vec E = -\odvod{\vec B}{t} & \qquad \nabla \times \vec H = \vec J_f + \odvod{\vec D}{t}
\end{aligned} 
\end{equation}
kjer veljata zvezi $\vec D = \varepsilon \varepsilon_0 \vec E$ in $\vec B = \mu \mu_0 \vec H$. 
V teko"cih kristalih sta dielektri"cnost $\varepsilon$ in permeabilnost $\mu$ anizotropna tenzorja. 
Obi"cajno pa je magnetna anizotropija mnogo "sibkej"sa od elektri"cne, zato jo lahko zanemarimo in privzamemo $\mu = 1$. 

Izvori in ponori valovanja znotraj vzorca so posledica neni"celne elektri"cne prevodnosti materiala.
Zaradi prevodnosti $\sigma$ ob prisotnosti elektri"cnega polja v snovi te"ce tok, ki je enak $\vec J = \sigma \vec E$. 
Prostih nabojev v vzorcu ni. Z upo"stevanjem zgornjih predpostavk lahko Maxwellove ena"cbe zapi"semo kotom
\begin{equation}
  \begin{aligned}
  \nabla \cdot \vec E = 0 & \qquad \nabla \cdot \vec B = 0 \\
  \nabla \times \vec E = -\odvod{\vec B}{t} & \qquad \nabla \times \vec B = \sigma \vec E + \varepsilon\varepsilon_0\mu_0\odvod{\vec E}{t}
  \end{aligned}
\end{equation}
V zadnji ena"cbi smo privzeli, da se dielektri"cni tenzor $\varepsilon$ ne spreminja s "casom, zato nastopa izved "casovnega odvoda. 
Ta predpostavka je smiselna pri obravnavi opti"cnih polj, saj je relaksacija teko"cega kristala mnogo po"casnej"sa od sprememb elektri"cnega in magnetnega polja. 

Pri numeri"cnem re"sevanju potrebujemo le zadnji dve ena"cbi, ki vsebujeta "casovne odvode polj. 
"Ce izrazimo "casovna odvoda in ena"cbi prepi"semo v brezdimenzijsko obliko ($c = \varepsilon_0 = \mu_0 = 1$), se glasita
\begin{align}
\label{eq:maxwell-base}
 \odvod{\vec{B}}{t} = -\nabla \times \vec{E}, \qquad \odvod{\vec{E}}{t} = \eps^{-1} (\nabla \times \vec{B} - \sigma \vec E)
\end{align}

\subsection{Teorija valovodov}
\todo{Preberi "clanke}

\section{Numeri"cna metoda}

Za samo ra"cunanje sem implementiral metodo kon"cnih diferenc v "casovni domeni \angl{\acf{FDTD}}. 
Pri tej metodi "casovno propagiramo elektri"cno in magnetno polje v vsaki to"cki po Maxwellovih ena"cbah

\begin{align}
\label{eq:maxwell-base}
 \odvod{\vec{B}}{t} = -\nabla \times \vec{E}, \qquad \odvod{\vec{E}}{t} = \eps^{-1} \nabla \times \vec{B}
\end{align}

V zgornjih ena"cbah smo implicitno upo"stevali, da v celici ni izvorov, uporabili pa smo brezdimenzijske enote, zato je $c=1$.

\subsection{Mre"za}

Pri diskretizaciji si lahko pomagamo z obliko obeh ena"cb. 
Za izra"cun "casovnega odvoda vsakega izmed polj $\vec{E}, \vec{B}$ potrebujemo le vrednosti drugega polja. 
Poleg tega obe ena"cbi povezujeta "casovni odvod enega polja s krajevnim odvodom drugega. 
Zaradi obeh opisanih lastnosti lahko dvignemo red metode, in s tem izbolj"samo natan"cnost, "ce vrednosti polj poznamo ob razli"cnih "casih in na razli"cnih mestih. 

Obi"cajne implementacije metode \acs{FDTD} gredo "se korak dlje, tako da so tudi posamezne komponente elektri"cnega in magnetnega polja definirane na razli"cih to"ckah\cite{yee, taflove, yee-lattice}.
Tak"sno mre"zo je predlagal Yee in izkori"s"ca dejstvo, da pri "casovnem odvodu vsake komponente posameznega polja nastopata le krajevna odvoda ostalih dveh komponent drugega polja. 
Z ustrezno izbiro to"ck, kjer so definirane posamezne komponente, so vsi krajevni odvodi izra"cunani ravno na sredini med ustreznima to"ckama mre"ze. 
Za u"cinkovito delovanje pa tak"sna mre"za zahteva, da je dielektri"cni tenzor $\eps$ diagonalen, njegove komponente pa morajo biti znane na razli"cnih to"ckah mre"ze. 
V praznem prostoru ali v trdnih kristalih temu pogoju lahko zadostimo, po mo"znosti z vrtenjem koordinatnega sistema.

V teko"cih kristalih je dielektri"cni tenzor anizotropen in se mo"cno spreminja s krajem. 
Zaradi krajevnega spreminjanja ne moremo tako obrniti koordinatnega sistema, da bi bil tenzor diagonalen v vseh to"ckah. 
Poleg tega obstoje"ce modeliranje ureditve teko"cih kristalov poda vse komponente dielektri"cnega tenzorja na istem mestu. 
Odlo"cil sem se za srednjo pot, kjer sta polji $\E$ in $\B$ definirani ob razli"cnih "casih in na razli"cnih to"ckah mre"ze, vse tri komponente vsakega izmed polj pa so podane na istem mestu. 
Obe mre"zi prikazuje slika \ref{fig:lattice}. 

\begin{figure}[h]
\centering
 \subfigure{\includegraphics[width=.5\textwidth]{./Slike/Yee-cube}}
 \subfigure{\begin{tikzpicture}[scale=1.4]
    
    \foreach \x in {0,1}{
      \foreach \y in {0,1}{
        \node[mpoint] at (2*\x,2*\y) {}; 
        \node[mpoint] at (2*\x+1.2,2*\y+0.8) {}; 
        \node[epoint] at (2*\x+1.6,2*\y+1.4) {};
        \node[epoint] at (2*\x+1.6-1.2,2*\y+1.4-0.8) {};
        \draw[mgrid] (2*\x,2*\y) -- (2*\x+1.2,2*\y+0.8);
        \draw[egrid] (2*\x+1.6,2*\y+1.4) -- (2*\x+1.6-1.2,2*\y+1.4-0.8);
      }
    }
    
    \draw[mgrid] (0,0) rectangle (2,2);
    \draw[mgrid] (1.2,0.8) rectangle (3.2,2.8);
    \draw[egrid] (1.6,1.4) rectangle (3.6,3.4);
    \draw[egrid] (1.6-1.2,1.4-0.8) rectangle (3.6-1.2,3.4-0.8);

            \end{tikzpicture}}
\caption{Levo: Yeejeva celica, pri kateri so komponente elektri"cnega polja znane na razpolovi"s"cih robov konce, komponente magnetnega polja pa v sredi"s"cih ploskev\cite{yee-lattice}. Desno: Celica, ki sem jo uporabil pri izra"cunih. Komponente elektri"cnega polja so znane v ogli"s"cih kocke, komponente magnetnega polja pa v njenem sredi"s"cu. V obeh primerih sta elektri"cno in magnetno polje dolo"cena ob razli"cnih "casih, kar na sliki ni prikazano.}
\label{fig:lattice}
\end{figure}

Za ra"cun potrebujemo "se inverz dielektri"cnega tenzorja, ki pa se med propagacijo svetlobe ne spreminja, zato ga lahko izra"cunamo predhodno. 
Pomembno je le, da je znan na istem mestu kot $\E$ (rde"ce to"cke na sliki \ref{fig:lattice}), vendar ob "casu, ko je podan $\B$. 

\subsection{Ena"cbe}

Na izbrani mre"zi ne moremo neposredno izra"cunati rotorja polj, ker ta ni definiran v pravih to"ckah. 
Elektri"cno polje je definirano na ogli"s"cih kocke, zato so krajevni odvodi tega polja definirani na razpolovi"s"cih robov, potrebujemo pa jih na mestu magnetnega polja, torej v sredi"s"cu kocke. 
V svoji metodi sem za odvod polja po vsaki koordinati v sredi"s"cu kocke uporabil povpre"cje odvodov na vseh "stirih robovih, ki potekajo v smeri izbrane koordinate, kot prikazuje slika \ref{fig:lattice-derivatives}. 

\begin{figure}[h]
\centering
 \begin{tikzpicture}
  \foreach \y in {0,1}{
      \foreach \x in {0,1}{
        \node[epoint] at (2*\x+1.6,2*\y+1.4) {};
        \node[epoint] at (2*\x+1.6-1.2,2*\y+1.4-0.8) {};
        \draw[egrid] (2*\x+1.6,2*\y+1.4) -- (2*\x+1.6-1.2,2*\y+1.4-0.8);
      }
      \draw[->,red,ultra thick] (1.4+1,2*\y+1.4) -- +(0.4,0);
      \draw[->,red,ultra thick] (0.2+1,2*\y+0.6) -- +(0.4,0);
    }
    
    \draw[egrid] (1.6,1.4) rectangle (3.6,3.4);
    \draw[egrid] (1.6-1.2,1.4-0.8) rectangle (3.6-1.2,3.4-0.8);
    
    \node[mpoint] at (2,2) {};
 \end{tikzpicture}
 \caption{
 Krajevni odvodi komponent polja $\E$ v smeri $x$ so definirani na "stirih robovih, ozna"cenih s pu"s"cicami. 
 Vrednost potrebujemo v sredi"s"cu kocke (modra pika), zato sem uporabil povpre"cje "stirih vrednosti na robu. 
 }
 \label{fig:lattice-derivatives}
\end{figure}

V primerjavi z Yeejevo celico povpre"cenje pove"ca "cas ra"cunanja, saj moramo namesto vsakega krajevnega odvoda izra"cunati "stiri. 
Na sre"co pa si vsah rob delijo "stiri kocke, tako da se s sprotnim shranjevanjem odvodov lahko izognemo ve"ckratnemu ra"cunanju istega odvoda. 
Na ta na"cin je "stevilo ra"cunskih operacij blizu tistemu, ki bi ga potrebovali z uporabo Yeejeve mre"ze. 

\subsection{Izvor valovanja}

V ena"cbah (\ref{eq:maxwell-base}) ne nastopajo izvori valovanja, zato jih moramo moramo modelirati z robnimi pogoji. 
To je v skladu z eksperimenti, saj svetloba pride od zunaj, zanima pa nas predvsem njeno "sirjenje skozi snov. 

Poljubno vpadno valovanje lahko modeliramo z robnimi pogoji, "ce izkoristimo linearnost Maxwellovih ena"cb. 
Elektri"cno in magnetno polje lahko namre"c razcepimo na vsoto vpadnega in sipanega valovanja\cite{taflove}. 
Tak"sen razcep polja je mo"zen le, "ce je "sirjenje vpadnega valovanja dobro znano. 
Mre"zo zato razdelimo na dve obmo"cji, v notranjem obmo"cju ra"cunamo s skupnim poljem, v zunanjem pa polje razcepimo in shranjujemo le sipani del.
Opti"cno anizotropna snov mora biti v celoti v notranjem obmo"cju. \todo{slikca}

Izvor valovanja modeliramo na prehodu med obmo"cjema. 

Delitev na notranje in zunanje obmo"cje je u"cinkovita, "ce se efektivni lomni koli"cnik v notranem obmo"cju ne razlikuje mo"cno od zunanjega. 
V tem primeru je fazna razlika na zadnji stranici notrenjega obmo"cja dovolj majhna, da pretvorba na sipano valovanje odstrani ve"cino valovanja. 
"Ce pa je fazna razlika primerljiva s $\pi/2$ ali ve"cja, lahko odstranitev vpadnega vala celo pove"ca amplitudo valovanja. 
To se zgodi npr. v teko"cekristalnem valovodu, ki je mnogo dalj"si od valovne dol"zine svetlobe. 
Takrat je bolj u"cinkovito upo"stevati izvor valovanja le na vpadni strani. 

\begin{figure}[h]
 \centering
 \includegraphics[width=.8\textwidth]{./Slike/wave-source-regions}
 \caption{Delitev mre"ze na dve obmo"cji. V obmo"cju \textbf{A} ra"cunamo le z sipanim valovanjem, v obmo"cju \textbf{B} pa s celotnim valovanjem. Delitev na levi sliki je primerna, "ce je razlika med lomnima koli"cnikoma \textbf{A} in \textbf{B} dovolj majhna. V nasprotnem primeru uporabimo delitev na desni sliki. }
 \label{fig:wave-source-regions}
\end{figure}

Delitev na zunanje in notranje obmo"cji, ki je prikazana na levi strani slike \ref{fig:wave-source-regions}, sem uporabil le s preprostimi primeri za preverjanje delovanja metode. 
Vse ostale izra"cune sem izvajal z delitvijo na desni strani. 
Na sliki je velikost obmo"cja \textbf{A} pretirana zaradi preglednosti. 
V vseh primerih je bila debelina obmo"cja \textbf{A} enaka dva koraka mre"ze. 

\subsection{Robni pogoji}

"Ce imamo na robu celice Dirichletov, Neumannov ali me"sani robni pogoj, se bo celotno valovanje odbilo in vrnilo v celico. 
Tega si ne "zelimo, pri izvedbi ekperimentov obi"cajno svetloba najprej preide skozi vzorec, nato pa jo zajamemo in preu"cimo. 
To lahko simuliramo z uporabo absorbirajo"cega robnega pogoja \angl{\ac{ABC}}. 
Obstaja ve"c razli"cnih implementacij absorbirajo"cih robnih pogojev, v zadnjem "casu se najve"c uporablja t.i. popolnoma ujemajo"ca plast \angl{\ac{PML}}\cite{taflove,berenger}. 

Material v plasti \acs{PML} zagotavlja eksponentno pojemanje vpadnega vala, neodvisno od njegove frekvence in smeri "sirjenja. 
Absorpcijo valovanja dose"zemo z uporabo elektri"cne prevodnosti $\sigma$ in magnetnih izgub $\sigma^*$. 
Odboju na meji med notranjostjo celice in plastjo \acs{PML} se izognemo, "ce izgube v robni plasti zado"s"cajo pogoju $\sigma/\sigma^* = \eps_1/\mu_1$, kjer sta $\eps_1$ in $\mu_1$ dielektri"cnost in magnetna permeabilnost v notranjosti. 
To ujemanje izgub odpravi odboj na meji le za valovanje, ki vpada pravokotno na mejo. 
Odboj valovanja pod poljubnim kotom prepre"cimo, "ce vsako komponento elektri"cnega in magnetnega polja razdelimo na dva prispevka. 
Tak material je nefizikalen, saj imamo dodatne prostostne stopnje, polje pa ne sledi ve"c Maxwellovim ena"cbam. 

Komponenta $E_x$ elektri"cnega polja vala v obi"cajnem mediju z dielektri"cnostjo $\eps$ in elektri"cno prevodnostjo $\sigma$ zado"s"ca Maxwellovi ena"cbi

\begin{align}
 \eps \odvod{E_x}{t} + \sigma E_x = \odvod{H_z}{y} - \odvod{H_y}{z}\;.
\end{align}

V plasti \acs{PML} pa elektri"cno polje razdelimo na dva prispeka, $E_x = E_{xy} + E_{xz}$, ki zado"s"cata ena"cbam

\begin{align}
 \eps \odvod{E_{xy}}{t} + \sigma_y E_{xy} &= \odvod{}{y}(H_{zx} + H_{zy}) \\
 \eps \odvod{E_{xz}}{t} + \sigma_z E_{xz} &= -\odvod{}{z}(H_{yx} + H_{yz})\;,
\end{align}

kjer smo razcepljenima komponentoma pripisali razli"cni prevodnosti. 
Na enak na"cin so razcepljene ostale komponente eletri"cnega in magnetnega polja. 

\subsection{Opis valovoda}



\section{Preverjanje metode}

\todo{Test z dejasnkim profilom, ki ga imajo v opti"cnih vodniki}

\subsection{Prazen prostor}
Prvi preizkus metode, ki sem ga opravil, je "sirjenje svetlobe skozi prazen prostor. 
Prazen prostor sem modeliral kot snov, kjer je dielektri"cni tenzor uniformen in izotropen. 
"Ce na eno stran celice postavimo planarni izvir ravnega valovanja, pri"cakujemo ravne valove po celotnem mediju. 
\begin{figure}[h]
 \centering
 \subfigure{\includegraphics[width=.45\textwidth]{g_test_plane}} \,
 \subfigure{\includegraphics[width=.45\textwidth]{g_test_plane_profile}}
\caption{Levo: Trenutna slika valovanja v celici. Desno: "Casovna in krajevna odvisnost valovanja. \todo{Bolj"si opis, pu"s"cice na slikah}}
\label{fig:test-plane}
\end{figure}
Na obeh slikah opazimo rob, kjer ni valovanja. 
To je posledica planarnega modeliranja izvora valovanja, kot je prikazano na sliki \ref{fig:wave-source-regions}. 
Pri tem preizkusu sta lomna koli"cnika v obeh obmo"cjih enaka, zato sem mre"zo razdelil na notranje in zunanje obmo"cje. 

\subsection{Lom in odboj}

  

\subsection{Uniformen direktor}

Za naslednji preizkus sem simuliral dvolomni kristal, torej snov, kjer je dielektri"cni tenzor uniformen, ne pa tudi izotropen. 
Svetloba se je "sirila v smeri osi $z$, opti"cna os pa je oklepala kot $\theta$ z ravnino $x$-$y$ in kot $\beta$ s polarizacijo vpadne svetlobe. 
Preu"ceval sem prepustnost tak"snega sistema, "ce za celico postavimo polarizator, ki je pravokoten na polarizacijo vpadne svetlobe. 
Intenziteto prepu"s"cene svetlobe lahko izpeljemo analiti"cno\cite{kleman}, enaka je
\begin{align}
 I &= I_0 \sin^2 2\beta \sin^2 \left[ \frac{\pi d}{\lambda_0} \left( \frac{n_o n_e}{\sqrt{n_e^2 \cos^2 \theta + n_0^2 \sin^2 \theta}} - n_o \right)\right],
\end{align}
kjer sta $I_0$ in $\lambda_0$ intenziteta in valovna dol"zina vpadne svetlobe, $d$ debelina vzorca, $n_o$ in $n_e$ pa redni in izredni lomni koli"cnik. 
Ujemanje rezultatov z napovedjo je prikazano na sliki \ref{fig:test-uniform}.
\todo{vnesi parametre v graf}

\begin{figure}[h]
 \input{g_test_uniform}
 \caption{Rezultati preizkusa z uniformnim in anizotropnim dielektri"cnim tenzorjem}
 \label{fig:test-uniform}
\end{figure}

\newpage
\subsection{Periodi"cna modulacija}

%bandgap => prepovedani pas, energijska re"za
Pri periodi"cni modulaciji lomnega koli"cnika opazimo pojav, da se svetloba dolo"cenih frekvenc ne more "siriti po mediju\cite{joannopoulos}. 
Temu pojavu pravimo prepovedani pas \angl{band gap}. 
"Sirina in oblika tega pasu sta odvisni od obeh lomnih koli"cnikov, periode modulacije in velikosti kristala. 
Za preverjanje metode sem modeliral kristal, kjer se izmenjujejo plasti z izotropno dielektri"cnostjo $\varepsilon_1$ in $\varepsilon_2$. 
V smereh $x$ in $y$ sem uporabil periodi"cne robne pogoje, v smeri $z$ pa celico dol"zine 1024 enot z 20 enotami absorbirajo"ce plasti na vsakem koncu. 
Grafa prepustnosti kristalov z razli"cnimi izbirami za dielektri"cnosti sta na sliki \ref{fig:test-periodic}. 

\begin{figure}[h]
 \input{g_test_periodic}
 \caption{Rezultati preizkusa s periodi"cno modulacijo lomnega koli"cnika}
 \label{fig:test-periodic}
\end{figure}

Na sliki res opazimo oster padec prepustnosti v dolo"cenem frekven"cnem pasu. 
Ta frekven"cni pas se dobro ujema s pri"cakovanim, ki je na sliki \ref{fig:joannopoulos-crystal}. 
Metoda torej pravilno napove polo"zaj in "sirino prepovedanih pasov. 

\begin{figure}[h]
\centering
 \includegraphics[width=.8\textwidth]{./Slike/bandgap}
 \caption{Pojav energijske re"za v fotonskem kristalu. Levo: celotna plast ima dielektri"cnost $\varepsilon = 13$. Sredina: Izmenjevanje plasti z dielektri"cnima konstantama 13 in 12. Desno: Izmenjevanje plasti z dielektri"cnima konstantama 13 in 1. \cite{joannopoulos}}
 \label{fig:joannopoulos-crystal}
\end{figure}

\newpage
\subsection{Robni pogoji}

Za prepre"cevanje odboja na stranskih ploskvah sem uporabil absorbirajo"ce robne pogoje. 
Plast \acs{PML} nam omogo"ca, da imamo material s poljubno velikimi izgubami, pa vseeno ne dobimo odboja na meji, vse dokler so elektri"cne in magnetne izgube v primernem razmerju. 
V praksi pa se zaradi diskretizacije vseeno nekaj valovanja odbije na meji med notranjostjo celice in robno plastjo. 
Najti moramo torej ravnote"zje med dvema prispevkoma: "ce so izgube majhne, bo del valovanja pri"sel skozi robno plast in se odbil na zunanjem robu. 
"Ce pa so izgube prevelike, se bo del valovanja odbil "ze na notranjem robu. 
Oba prispevka lahko zmanj"samo, "ce pove"camo debelino robne plasti, ampak s tem se pove"ca tudi "cas ra"cunanja. 
Odboj na notranji steni pa lahko omilimo, "ce se izognemo ostri meji in izgube zvezno nara"s"cajo od notranjosti proti robu. 
V literaturi\cite{taflove} priporo"cajo poten"cno nara"s"canje izgub, $\sigma \propto (d-d_0)^{p}$, kjer je $d$ oddaljenost od zunanjega roba, $d_0$ pa debelina plasti. 

Za nekaj vrednosti $p$ sem izra"cunal odbojnost robne plasti z debelino 10 enot diskretizacije. Rezultati so prikazani na sliki \ref{fig:test-absorption}. 

\begin{figure}[h]
 \input{g_test_absorption}
 \caption{Odbojnost robne plasti debeline 10 enot pri razli"cnih profilih elektri"cnih in magnetnih izgub $\sigma$. Najbolje se izka"ze material, kjer izgube nara"s"cajo kvadratno z oddaljenostjo od roba celice ($p=2$). 
 \todo{Uporabi tako debelino, da bodo krivulje bolj razli"cne}
 }
 \label{fig:test-absorption}
\end{figure}

V primeru, da v plasti ni izgub, je njena odbojnost enaka 1, saj gre celotno valovanje skozi plast in se odbije na zunanji meji. 
"Ce izgume malo pove"camo, odbojnost v vseh primerih strmo pade. 
Pri profilih, kjer imamo nezveznost v izgubah ali v njihovem odvodu ($p<2$) pa odbojnost kmalu za"cne spet nara"s"cati, saj postane odboj na notranji meji "ze opazen.
Pri ve"cjih potencah pa lahko izgube "se pove"camo in s tem dose"zemo ni"zjo odbojnost plasti. 
V zgornjem primeru se za najbolj"si profil izka"ze kvadratno nara"s"canje absorpcije, zato sem za vse nadaljnje ra"cune uporabil tak"sno plast. 

\section{Rezultati}

\subsection{Smekti"cni valood}



\section{Zaklju"cek}

\newpage
\bibliographystyle{zumer}
\bibliography{magisterij}

\end{document}
