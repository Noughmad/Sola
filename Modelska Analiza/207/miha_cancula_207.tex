\documentclass[a4paper,10pt]{article}

\usepackage[utf8]{inputenc}
\usepackage[slovene]{babel}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{relsize}
\usepackage[smaller]{acronym}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{cite}
\usepackage{url}
\usepackage[unicode=true]{hyperref}
\usepackage{color}
\usepackage[version=3]{mhchem}
\usepackage{wrapfig}
\usepackage{comment}
\usepackage{float}
\usepackage[top=3cm,bottom=3cm,left=3cm,right=3cm]{geometry}

\renewcommand{\vec}{\mathbf}
\newcommand{\eps}{\varepsilon}
\renewcommand{\phi}{\varphi}
\renewcommand{\theta}{\vartheta}
\newcommand{\dd}{\mathrm{d}}

\newcommand{\parcialno}[2]{
  \frac{\partial #1}{\partial #2}
}
\newcommand{\parcdva}[2]{
  \frac{\partial^2 #1}{\partial #2 ^2}
}
\newcommand{\lag}{\mathcal{L}}

\title{Metoda kon\v cnih elementov: \\ Poissonova ena\v cba}
\author{Miha \v Can\v cula}
\begin{document}

\maketitle

\section{Postopek re"sevanja}

\subsection{Diskretizacija}

Prednost metode kon"cnih elementov je v tem, da lahko prostor razdelimo na trikotnike s poljubnim tlakovanjem. Za "cim bolj"so natan"cnost metode je koristno, da so trikotniki pribli"zno enakostrani"cni in enake velikosti. 

\subsubsection{Polkrog}

V polkro"zni geometriji sem se temu posku"sal pribli"zati na dva na"cina:

\begin{enumerate}
 \item Sredi"s"cno tlakovanje, pri polkrog razdelimo na kolobarje, nato pa vsak kolobar posebej tlakujemo s trikotniki. 
 \item Heksagonalno tlakovanje, kjer je notranjost polkroga tlakovana s pravilno mre"zo, le na robu so popravki da se pribli"zamo polkro"zni obliki. 
\end{enumerate}

Za najte"zji del naloge se je izkazalo iskanje povezav med to"ckami. Izbrana metoda namre"c zahteve tlakovanje s samimi trikotniki, tako da moramo prepre"citi kri"zanje povezav, pa tudi povezane "stirikotnike. Pri obeh izbranih metoda se izka"ze, da je za dovolj grobe diskretizacije uporaben pristop, ko to"cke povezujemo med seboj le na podlagi medsebojne razdalje. Mejna razdalja mora biti nekje med $a$ in $a\sqrt{2}$, kjer je $a$ tipi"cna razdalja med to"ckami. 

\begin{figure}[H]
\subfigure{\includegraphics[width=.45\textwidth]{g_povezave_sred}}
\subfigure{\includegraphics[width=.45\textwidth]{g_povezave_hex}}
\caption{Obe razli"cni diskretizaciji preseka polkro"zne cevi}
\label{fig:povezave-polkrog}
\end{figure}


\subsubsection{Izsekan kvadrat}

Tlakovanje cevi iz 5. naloge je bilo la"zje, saj tu nimamo okroglih oblik. Delo sem si dodatno poenostavil s tem, da nisem uporabil enakostrani"cnih trikotnikov, ampak enakokrake pravokotne (torej polovico kvadrata). Na ta na"cin sem "zrtvoval nekaj natan"cnosti, saj je hipotenuza dalj"sa od stranice v enakostrani"cnem trikotniku z enako plo"s"cino. Tak"sno tlakovanje pa omogo"ca enostavno pokritje ostrih izsekanih vogalov cevi, hkrati pa se izogne tudi mrtvim trikotnikom v pravokotnih vogalih. 

\begin{figure}[H]
\subfigure{\includegraphics[width=.45\textwidth]{g_batman_18}}
\subfigure{\includegraphics[width=.45\textwidth]{g_batman_30}}
\caption{Diskretizacija cevi s presekom v obliki izrezanega kvadrata pri razli"cnem "stevilu to"ck}
\label{fig:povezave-batman}
\end{figure}

Prednost tak"snega tlakovanja v primerjavi s polkro"zno cevjo je pri iskanju povezav. Povezave med to"ckami kvadratne cevi sem lahko povezal po nekem pravilu, brez da bi ra"cunal medsebojne razdalje. 

\subsection{Re"sevanje matri"cnega sistema}

Naslednji korak po dolo"citvi polo"zaja to"ck in povezav med njimi je priprava matri"cnega sistema za re"sevanje. Pri tem nastopajo skalarni produkti konstantih funkcij in pa plo"s"cine trikotnikov. To lahko izra"cunamo s preprostimi formulami, ki so napisane tudi v navodilih. Geometrijo moramo upo"stevati le "se za dolo"citev, katere to"cke so na robu, nato pa jo lahko pozabimo. 

Pozornost pa je treba posvetiti "se robnim pogojem. Ra"cunamo vrednost funkcije $u$ le v to"ckah, ki niso na robu obmo"cja, saj imamo robni pogoj "ze podan. Notranjim to"ckam sem priredil vrstico, podano z elementi in desno stranjo kot so opisani v navodilih. Vrstice, ki pripadajo robnim to"ckam, pa so imele le diagonalni element neni"celn, pripadajo"co desno stran pa 0. S je bila matrika $A$ ve"cja, kot je nujno potrebno, kar seveda pomeni po"casnej"se ra"cunanje. Ker pa je matrika $A$ redka in se za re"sevanje matri"cnega sistema uporabil knji"znico za redke matrike \texttt{cholmod}, se dodatek majhnega "stevila diagonalnih "clenov ni mo"cno poznal. 

V "casu okrog ene minute mi je uspelo re"siti primer z nekaj ve"c kot 10000 to"ck. 

\section{Re"sitve}

Rezultat metode FEM je te"zko prikazati kot 3D graf, saj to"cke niso enakomerno porazdeljene po ravnini $xy$. Zaradi pomanjkanja "casa sem jih vseeno narisal kar v Gnuplotu. Na grafih sicer ne vidimo posameznih trikotnikov, pa tudi robovi so prikazani nekoliko nerodno, sama oblika re"sitve pa je vseeno jasna. Zaradi druga"cnega vrstnega reda to"ck mi ni uspelo jasno prikazati profila s heksagonalno delitvijo, sem pa preveril da je na pogled zelo podoben tistemu na Sliki \ref{fig:profil-srediscna}. 

\begin{figure}[H]
\centering
 \input{g_profil_srediscna}
 \caption{Profil hitrosti v polkro"zni cevi, sredi"s"cna diskretizacija}
 \label{fig:profil-srediscna}
\end{figure}

\begin{figure}[H]
\centering
 \input{g_profil_kvadrat}
 \caption{Profil hitrosti v cevi z obliko izrezanega kvadrata}
 \label{fig:profil-kvadrat}
\end{figure}


\section{Pretok po cevi}

Kon"cno sem izra"cunal "se pretok teko"cine po cevi z izbranim profilom. Ker trikotniki nimajo enakih plo"s"cin, je tudi te"za vsakega izra"cunanega koeficienta razli"cna. Pretok, ki pripada to"cki $i$, sem izrazil kot produkt vrednosti $w_i$ in tretjine plo"s"cin vseh trikotnikov, ki mejijo na to to"cko. Tretjina nastopa z enakim razlogom kot pri vektorju desnih strani, ker je 1/3 integral linearne funkcije po trikotniku. Zaradi te lastnosti lahko pretok po cevi hitro izra"cunamo kot skalarni produkt $\vec x \cdot \vec b$.  

Pri izbiri matri"cnih elementov, kot so opisani v navodilih, pa maksimum re"sitve in s tem tudi pretok nara"s"ca linearno s "stevilom to"ck. Zato sem povsod risal koli"cino 

\begin{align}
 \Phi = \frac{\langle \vec x, \vec b\rangle}{n}
\end{align}


\begin{figure}[H]
 \input{g_pretok_polkrog}
 \caption{Pretok po polkro"zni cevi, diskretizirani na oba na"cina}
 \label{fig:pretok-polkrog}
\end{figure}

Opazimo razliko med obema pristopoma za diskretizacijo polkro"zne cevi. Za bolj"so se izka"ze razdelitev na kolobarje, saj da vi"sjo vrednost pretoka, hkrati se pa tudi bolje prilagaja modelu poten"cne konvergence. Pri heksagonalni razdelitvi opazimo skoke, ki so verjetno posledica neenakomerne velikosti trikotnikov na robu. 

\begin{figure}[H]
 \input{g_pretok_kvadrat}
 \caption{Pretok po cevi v obliki izrezanega kvadrata}
 \label{fig:pretok-kvadrat}
\end{figure}

Prave vrednost, ki je limita pri $n\to\infty$, seveda ne moremo izra"cunati na ta na"cin, lahko pa jo ocenimo. Pri tem nam pomaga dejstvo, da ocena za $\Phi$ monotono nara"s"ca s "stevilom to"ck $n$. Privzel sem poten"cno konvergenco in izra"cunanim vrednostim priredil funkcijo

\begin{align}
 \Phi(n) = \Phi_0 - \alpha \cdot n^{-\beta}
\end{align}

Optimalno vrednost parametra $\Phi_0$ je ocena za preto"cnost cevi, potenca $\beta$ pa stopnja konvergence. Pri vseh treh izra"cunih je optimanla vrednost $\beta$ med 0.4 in 0.5, torej nenatan"cnost pada pribli"zno s korenom "stevila to"ck. Konvergenca je o"citno precej po"casna, kar potrjujejo tudi izra"cuni, saj tudi pri ve"c kot 10000 to"ckah pretok "se vedno vztrajno nara"s"ca. 

Pri re"sevanju pete naloge s pospe"seno relaksacijo sem dobil rezultat $\Phi_{SOR} \approx 0.01631$. Domnevam, da je odstopanje posledica zgoraj opisane normalizacije pretoka (moral sem deliti z $n$), pri "cemer nastopa "se neznana multiplikativna konstanta. V primeru izrezane kvadratne cevi sem dobil pretok, ki je premajhen pribli"zno za faktor $5/2$. 

\section{Hitrost re"sevanja}

Meril sem tudi "cas, ki ga algoritem porabi za re"sevanje problema

\begin{figure}[H]
 \input{g_hitrost}
 \caption{"Cas izvajanja programa}
 \label{fig:hitrost}
\end{figure}

Z grafa lahko vidimo, da "cas izvajanja ni odvisen od geometrije problema ali izbire diskretizacije, le od "stevila to"ck. V vseh treh izbranih diskretizacijah "cas ra"cunanja nara"s"ca z drugo potenco $n$, torej je algoritem reda $\mathcal{O}(n^2)$.

Pri majhnem "stevilu to"ck je ra"cun s kvadratno cevjo hitrej"si, ker sem se lahko izognil ra"cunanju razdalj med vsemi to"ckami. Pri dovolj velikem $n$ pa razlika ni ve"c vidna, graf pa se mo"cno pribli"za premici. 

\end{document}
